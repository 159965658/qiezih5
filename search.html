<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>搜索页</title>

    <script src="js/jquery-1.8.2.min.js"></script>
    <script src="js/common.js"></script>
    <script src="js/swiper.min.js"></script>

    <link rel="stylesheet" href="css/common.css" />
    <link rel="stylesheet" href="css/swiper.min.css">
    <link rel="stylesheet" href="css/search.css" />
    <link rel="stylesheet" href="css/pullToRefresh.css" />
    <script src="js/iscroll.js"></script>
    <script src="js/pullToRefresh.js"></script>
    <script src="js/colorful.js"></script>
    <link rel="stylesheet" href="css/hotBBS.css">

</head>
<style>
    #wrapper{
        display: none;
    }
</style>
<body>
    <div class="content_top">
        <div class="content">

            <div class="left" id="removeCon">
                <a href="#"><img src="images/close_icon.png"></a>
            </div>
            <p><input type="text" id="name_con" placeholder="搜索用户、论坛、帖子"></p>
            <div class="right">
                <a href="#"><img src="images/search_logo.png"></a>
            </div>
        </div>
    </div>
    <div class="search">
        <div class="container tab">
            <div class="swiper-container swiper1">
                <div class="swiper-wrapper">
                    <div class="swiper-slide selected"><span>用户</span></div>
                    <div class="swiper-slide"><span>论坛</span></div>
                    <div class="swiper-slide"><span>帖子</span></div>
                </div>
            </div>
            <div class="swiper-container swiper2">
                <div class="swiper-wrapper">
                    <div class="swiper-slide ">
                        <div class="content">
                            <div class="search-content">

                                <div class="search-hot">
                                    <div class="title">热门搜索</div>
                                    <ul>
                                        <li><a href="#" class="clearfix"><span>1</span><b>面朝大海</b></a></li>
                                        <li><a href="#" class="clearfix"><span>2</span><b>面朝大海</b></a></li>
                                        <li><a href="#" class="clearfix"><span>3</span><b>面朝大海</b></a></li>
                                        <li><a href="#" class="clearfix"><span>4</span><b>面朝大海</b></a></li>
                                    </ul>
                                </div>

                                <div class="search-history">
                                    <div class="title">
                                        <span>历史搜索</span>
                                        <a class="clearBtn">清空</a>
                                    </div>
                                    <ul>
                                        <li>
                                            <a href="#"><span>春暖花开</span><b><img class="delete" src="images/close_icon1.png"
                                                        alt=""></b></a>
                                        </li>
                                        <li>
                                            <a href="#"><span>春暖花开</span><b><img class="delete" src="images/close_icon1.png"
                                                        alt=""></b></a>
                                        </li>
                                        <li>
                                            <a href="#"><span>春暖花开</span><b><img class="delete" src="images/close_icon1.png"
                                                        alt=""></b></a>
                                        </li>
                                        <li>
                                            <a href="#"><span>春暖花开</span><b><img class="delete" src="images/close_icon1.png"
                                                        alt=""></b></a>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="swiper-slide ">
                        <div class="content">
                            <div class="search-content">

                                <div class="search-hot">
                                    <div class="title">热门搜索</div>
                                    <ul>
                                        <li><a href="#" class="clearfix"><span>1</span><b>面朝大海</b></a></li>
                                        <li><a href="#" class="clearfix"><span>2</span><b>面朝大海</b></a></li>
                                        <li><a href="#" class="clearfix"><span>3</span><b>面朝大海</b></a></li>
                                        <li><a href="#" class="clearfix"><span>4</span><b>面朝大海</b></a></li>
                                    </ul>
                                </div>

                                <div class="search-history">
                                    <div class="title">
                                        <span>历史搜索</span>
                                        <a class="clearBtn">清空</a>
                                    </div>
                                    <ul>
                                        <li>
                                            <a href="#"><span>春暖花开</span><b><img class="delete" src="images/close_icon1.png"
                                                        alt=""></b></a>
                                        </li>
                                        <li>
                                            <a href="#"><span>春暖花开</span><b><img class="delete" src="images/close_icon1.png"
                                                        alt=""></b></a>
                                        </li>
                                        <li>
                                            <a href="#"><span>春暖花开</span><b><img class="delete" src="images/close_icon1.png"
                                                        alt=""></b></a>
                                        </li>
                                        <li>
                                            <a href="#"><span>春暖花开</span><b><img class="delete" src="images/close_icon1.png"
                                                        alt=""></b></a>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="swiper-slide ">
                        <div class="content">
                            <div class="search-content">

                                <div class="search-hot">
                                    <div class="title">热门搜索</div>
                                    <ul>
                                        <li><a href="#" class="clearfix"><span>1</span><b>面朝大海</b></a></li>
                                        <li><a href="#" class="clearfix"><span>2</span><b>面朝大海</b></a></li>
                                        <li><a href="#" class="clearfix"><span>3</span><b>面朝大海</b></a></li>
                                        <li><a href="#" class="clearfix"><span>4</span><b>面朝大海</b></a></li>
                                    </ul>
                                </div>

                                <div class="search-history">
                                    <div class="title">
                                        <span>历史搜索</span>
                                        <a class="clearBtn">清空</a>
                                    </div>
                                    <ul>
                                        <li>
                                            <a href="#"><span>春暖花开</span><b><img class="delete" src="images/close_icon1.png"
                                                        alt=""></b></a>
                                        </li>
                                        <li>
                                            <a href="#"><span>春暖花开</span><b><img class="delete" src="images/close_icon1.png"
                                                        alt=""></b></a>
                                        </li>
                                        <li>
                                            <a href="#"><span>春暖花开</span><b><img class="delete" src="images/close_icon1.png"
                                                        alt=""></b></a>
                                        </li>
                                        <li>
                                            <a href="#"><span>春暖花开</span><b><img class="delete" src="images/close_icon1.png"
                                                        alt=""></b></a>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

    </div>

    <div class="hotBBS" id="wrapper" style="position:relative">
        <ul class="list">
            <li>
                <div class="item">
                    <div class="left">
                        <img src="images/hotBBS_pic.png" alt="">
                    </div>
                    <div class="right">
                        <div class="top">吃鸡秘笈</div>
                        <div class="bottom">
                            <p><span>主题数：</span><span>26112</span></p>
                            <p><span>关注人数：</span><span>400302</span></p>
                        </div>
                        <div class="btn">+关注</div>
                    </div>
                </div>
            </li>

            <li>
                <div class="item">
                    <div class="left">
                        <img src="images/hotBBS_pic.png" alt="">
                    </div>
                    <div class="right">
                        <div class="top">吃鸡秘笈</div>
                        <div class="bottom">
                            <p><span>主题数：</span><span>26112</span></p>
                            <p><span>关注人数：</span><span>400302</span></p>
                        </div>
                        <div class="btn">+关注</div>
                    </div>
                </div>
            </li>

            <li>
                <div class="item">
                    <div class="left">
                        <img src="images/hotBBS_pic.png" alt="">
                    </div>
                    <div class="right">
                        <div class="top">吃鸡秘笈</div>
                        <div class="bottom">
                            <p><span>主题数：</span><span>26112</span></p>
                            <p><span>关注人数：</span><span>400302</span></p>
                        </div>
                        <div class="btn">+关注</div>
                    </div>
                </div>
            </li>

            <li>
                <div class="item">
                    <div class="left">
                        <img src="images/hotBBS_pic.png" alt="">
                    </div>
                    <div class="right">
                        <div class="top">吃鸡秘笈</div>
                        <div class="bottom">
                            <p><span>主题数：</span><span>26112</span></p>
                            <p><span>关注人数：</span><span>400302</span></p>
                        </div>
                        <div class="btn">+关注</div>
                    </div>
                </div>
            </li>

            <li>
                <div class="item">
                    <div class="left">
                        <img src="images/hotBBS_pic.png" alt="">
                    </div>
                    <div class="right">
                        <div class="top">吃鸡秘笈</div>
                        <div class="bottom">
                            <p><span>主题数：</span><span>26112</span></p>
                            <p><span>关注人数：</span><span>400302</span></p>
                        </div>
                        <div class="btn">+关注</div>
                    </div>
                </div>
            </li>
        </ul>
    </div>

    <div class="content_bottom">
        <a href="#" class="active">
            <span><img src="images/bottom_phone.png" alt="" /></span>
            <span>推荐</span>
        </a>

        <a href="#">
            <span><img src="images/bottom_zn.png" alt="" /></span>
            <span>发现</span>
        </a>

        <a href="#">
            <span><img src="images/bottom_message.png" alt="" /></span>
            <span>社区</span>
        </a>

        <a href="#">
            <span><img src="images/bottom_user.png" alt="" /></span>
            <span>我的</span>
        </a>
    </div>
</body>
<script>
    $(function () {
        $('.search .tab span').on('click', function () {
            $('.search .tab span').removeClass('active');
            $(this).addClass('active');
        })
        $('.delete').on('click', function () {

            $(this).parent().parent().remove()
        })

        $('.clearBtn').on('click', function () {

            $(this).parent().siblings('ul').remove()
        })
    })
</script>
<script>
    $(function () {

        var settime = 500, // 切换标签的时间
            typeIndex = 0, //搜索类型 默认为0
              isData = false //是否有搜索数据
            ;
        //清空内容
        $('#removeCon').on('click',function(){
            setSearchCon();
        });
        //搜索
        $('.content > .right').on('click', function () {
	        isData = true ; //假设点击搜索后产生数据

            swipeConAjax();
        });
        //获取搜索内容
        function getSearchCon() {
            return $('#name_con').val();
        }
        //set搜索内容
        function setSearchCon(val = '') {
            return $('#name_con').val(val);
        }
        //发送请求
        function swipeConAjax(index = typeIndex) { // 0 == 用户 1 == 论坛 2 == 帖子
            typeIndex = index;

            setTimeout(() => { //此处  等到切换标签完成 进行 请求。根据后台需求完成
                //清空搜索内容   setSearchCon();
	            if(isData){
		            $('#wrapper').show();
		            $('.swiper2').hide();

	            }
                console.log(`类型：${typeIndex}, 搜索内容：${getSearchCon()}`); // ajax 请求
            }, settime);

        }
        function setCurrentSlide(ele, index) {
            $(".swiper1 .swiper-slide").removeClass("selected");
            ele.addClass("selected");
            swipeConAjax(index);
        }

        var swiper1 = new Swiper('.swiper1', {
            //					设置slider容器能够同时显示的slides数量(carousel模式)。
            //					可以设置为number或者 'auto'则自动根据slides的宽度来设定数量。
            //					loop模式下如果设置为'auto'还需要设置另外一个参数loopedSlides。
            slidesPerView: 3,
            paginationClickable: true,//此参数设置为true时，点击分页器的指示点分页器会控制Swiper切换。
            spaceBetween: 0,//slide之间的距离（单位px）。
            freeMode: true,//默认为false，普通模式：slide滑动时只滑动一格，并自动贴合wrapper，设置为true则变为free模式，slide会根据惯性滑动且不会贴合。
            loop: false,//是否可循环
            onTab: function (swiper) {
                var n = swiper1.clickedIndex;

            }
        });
        swiper1.slides.each(function (index, val) {
            var ele = $(this);
            ele.on("click", function () {
                setCurrentSlide(ele, index);
                swiper2.slideTo(index, settime, false); 
            });
        });

        var swiper2 = new Swiper('.swiper2', {
            //freeModeSticky  设置为true 滑动会自动贴合
            direction: 'horizontal',//Slides的滑动方向，可设置水平(horizontal)或垂直(vertical)。
            loop: false,
            //					effect : 'fade',//淡入
            //effect : 'cube',//方块
            //effect : 'coverflow',//3D流
            //					effect : 'flip',//3D翻转
            autoHeight: true,//自动高度。设置为true时，wrapper和container会随着当前slide的高度而发生变化。
            onSlideChangeEnd: function (swiper) {  //回调函数，swiper从一个slide过渡到另一个slide结束时执行。
                var n = swiper.activeIndex;
                setCurrentSlide($(".swiper1 .swiper-slide").eq(n), n);
                swiper1.slideTo(n, settime, false);
            }
        });
    });


    refresher.info = {
	    "pullDownLable": "Pull down to refresh...",
	    "pullingDownLable": "Release to refresh...",
	    "pullUpLable": "Pull up to load more...",
	    "pullingUpLable": "Release to load more...",
	    "loadingLable": "Loading..."
    }
    refresher.init({
	    id: "wrapper",
	    pullDownAction: Refresh,
	    pullUpAction: Load
    });
    function Refresh() {
        // console.log('刷新');
	    setTimeout(function () {

		    wrapper.refresh()
		    console.log(111)
	    }, 1000);

    }
    function Load() {
	    setTimeout(function () {

		    wrapper.refresh()
		    console.log(111)
	    }, 1000);
    }
</script>

</html>